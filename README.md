# Заключительное задание первого модуля

Ваша задача в этом уроке — загрузить данные в Elasticsearch из PostgreSQL. Подробности задания в папке `etl`.

## Установка и запуск
В `Makefile` есть команды, чтоб поднять и запустить ETL-процесс:

```shell
# Поднять контейнеры, залить данные в Postgres, запустить ETL:
make up

# Остановить ETL:
make down

# Посмотреть логи ETL-процесса:
make etl-logs
```

Чтобы визуально проверить данные в Elastic можно воспользоваться https://app.elasticvue.com/ В контейнере для ElasicSearch
октрыт порт `9200` и прописаны настройки для CORS.

## Реализация
Основная идея скрипта — бесконечно ходить по таблицам `film_work`, `person` и `genre` небольшой задержкой,
стягивая данные о фильмах для конвертации в Elastic. Все запросы в базу делаются порционно через генераторы,
конвертируются и сохраняются в Elasic.

Если происходит ошибка при подключении к Postgres или Elastic, то текущий коннект закрывается и создаётся новый через
`backoff`.